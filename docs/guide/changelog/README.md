# 更新日志

## v1.3.1
* [新增] 增加二次开发公共函数专用文件"function.php"
* [新增] 增加自定义接口(二次开发)版本号"v2"使用演示代码

- [修正] 系统服务增加异常处理,避免首次安装时报错
- [修正] 模块"install"被列为禁止访问模块，除首次安装以外，安装结束后将不可访问
- [修正] 根目录下的".gitignore"文件进行了规则调整
- [修正] 在API调试环境下,模拟的账号用户组由"超级管理员"调整至"普通顾客"
- [修正] API模块基类下去除了不必要的成员变量
- [修正] API模块下的控制器类对成员函数"方法路由器"结构进行了调整

* [优化] 优化"Stats"控制器验证规则
* [优化] 调整框架"系统服务"结构
* [优化] "获取系统配置参数"移动至系统服务
* [优化] 命令行调整，清理缓存后空文件夹也将被删除
* [优化] 优化"安装向导"检测及文件存放位置
* [优化] 批量调用API接口时,对控制器中的成员函数调用已支持

## v1.3.0
商城框架系统整体重构至ThinkPHP6.0版，因此过程中的修复与优化不会全部列出

* [新增] 调试环境所有接口支持额外参数"is_debug"，当值为1并且出现错误，将列出详细的报告
* [新增] 增加"stats"控制器，内置接口"get.stats.data"(获取某一项数据统计)
* [新增] 在配置选项中增加"默认每页显示条数"(默认每页15条)配置项
* [新增] 在"API"模块基类中增加"翻页"与"排序"搜索器
* [新增] 增加全局函数"is_windows"，用以判断是否为Windows系统
* [新增] 增加"数据统计缓存时效(分)"配置项，用于数据分析缓存间隔时间
* [新增] 增加Time扩展类
* [新增] 商品增加"游览量"字段
- [修正] 对查询语句是否调整排序采用参数设置
- [修正] "oss"组件整体进行重构
- [修正] "payment"组件整体进行重构
- [修正] "barcode"、"captcha"、"image"、"ip2region"等扩展组件重构至composer方式支持
- [修正] 重构跨域的支持方式，更加便捷、智能
- [修正] 控制器中的命名空间改为"::class"方式
- [修正] 加强请求时间戳验证代码块，防止"strtotime"引起的解析时间不正确问题
* [优化] 文章分类关联文章数量统计查询优化
* [优化] 对部分缓存使用方式进行性能调整
* [优化] 强化"查询一条IPv4信息"接口，将支持查询数字地址

## v1.2.8
* 新增：增加内置Rest API调试工具
* 新增：增加接口"检测指定商品是否被收藏"
* 修复：商品筛选价格菜单显示的文本内容不正确
* 修复："筛选价格与品牌后获取商品Id"无效
* 修复：验证码使用获取的排序方式
* 修复："根据权限获取菜单列表"允许游客获取
* 优化：后台管理模板更新至1.8.0
* 优化：修改数据库模板后缀，避免错误方式导入数据库
* 优化：安装向导检测PHP最高版本
* 优化：修改返回数据为空时默认返回"空对象"
* 优化：错误返回时字段"data"也将存在

## v1.2.7
* 新增：增加安装向导
* 新增：增加非法资源类型过滤
* 新增：APP模块增加"module"字段,主要用于过滤方便
* 新增：验证当前账户是否有越级操作
* 修复：路径存在空格时运行报错
* 修复：购物车列表获取字段错误
* 修复："获取完整收货地址"处理国籍时变量名错误
* 修复："get_version"函数检测字符错误
* 修复：生产环境下请求缩略图报错
* 修复：PNG图片处理后透明色变白色
* 修复：SQL函数语句字段错误
* 修复：PHP7.0环境下模型"self::destroy"报错
* 修复：根据广告位置编码获取数据后子列表将根据类型进行解码
* 修复：二维码LOGO部分图片颜色失真
* 修复："根据商品分类获取指定类型的商品"接口传值，默认"商品分类编号"为全部
* 修复：API请求签名长度验证修改
* 修复：微信支付二维码生成
* 优化：区域数据结构调整
* 优化：URL路径调整,以适应未做伪静态环境下404错误
* 优化：GIF图片将不再支持样式处理(GD对多帧图片处理不了)
* 优化：第三方OSS删除资源如有报错将忽略,但本地数据库中的记录还是将被删除
* 优化：OSS上传模块外链地址添加检测,不允许附带前缀(http、https)
* 优化："获取指定编号商品的基础数据"接口增加返回字段"short_name,attachment"
* 优化：APP状态分离出函数单独验证
* 优化：更新SDK后对支付组件进行兼容更新
* 优化：接口"财务对账号进行资金调整"无来源订单号时系统自动生成

## v1.2.0
* 增加系统常量”APP_PUBLIC_PATH”
* ”admin”模块支持自定义入口
* 增加头部安全协议
* 增加”cookie”安全性
* 入口页添加头部协议,防止乱码显示.
* 修复一处菜单权限逻辑错误
* 支持跨域请求,支持参数配置允许跨域的域名
* 对 OPTIONS 请求进行友好返回
* 未授权或授权超时将返回401状态
* 访问api接口时权限不足返回403状态
* 修复权限模块存在的缺陷